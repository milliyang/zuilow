# DMS Service Configuration
DMS_HOST=0.0.0.0
DMS_PORT=11183
DMS_LOG_LEVEL=INFO
DMS_LOG_DIR=/app/dms/run/logs

# Web auth: session (browser login) + server-to-server (X-API-Key)
# SECRET_KEY: Flask session secret (optional, default random)
# DMS_API_KEY: If set, requests with header X-API-Key: <value> are allowed without login (e.g. zuilow)
# SECRET_KEY=
# DMS_API_KEY=your-shared-secret

# Gunicorn workers (default 1 = one InfluxDB connection, scheduler runs once)
# Increase only if you need higher HTTP concurrency
# GUNICORN_WORKERS=1

# Docker Compose Mode
# Options: 'internal' (default, with InfluxDB) or 'external' (external InfluxDB)
# This determines which docker-compose file to use
COMPOSE_MODE=internal

# InfluxDB Configuration (for Docker internal InfluxDB)
# 如果使用外部 InfluxDB，这些配置不会被使用
# DMS 会从 config/dms.yaml 读取数据库配置
INFLUXDB_HOST=influxdb
INFLUXDB_PORT=8086
INFLUXDB_USERNAME=admin
INFLUXDB_PASSWORD=admin123456
INFLUXDB_ORG=dms
INFLUXDB_BUCKET=dms_data
INFLUXDB_TOKEN=

# Note: If INFLUXDB_TOKEN is empty, InfluxDB will generate one during first setup
# You can retrieve it from InfluxDB UI or logs, then update this file

# ============================================
# 重要说明：InfluxDB 配置方式
# ============================================
# DMS 使用 config/dms.yaml 中的 primary.host 和 primary.port 连接 InfluxDB
# 
# 方案 A：使用外部 InfluxDB（推荐，如果已有 InfluxDB）
#   1. 在 config/dms.yaml 中配置外部 InfluxDB 地址（如 172.19.202.120）
#   2. 设置 COMPOSE_MODE=external 或使用环境变量 export COMPOSE_MODE=external
#   3. 运行 ./docker/docker_tools.sh up
#
# 方案 B：使用 Docker 内的 InfluxDB
#   1. 在 config/dms.yaml 中设置 primary.host = "influxdb"（Docker 服务名）
#   2. 或使用 host.docker.internal（Mac/Windows）或宿主机 IP（Linux）
#   3. 设置 COMPOSE_MODE=internal（默认值）
#   4. 运行 ./docker/docker_tools.sh up
